var rsb = rsb || {};rsb.editors = [];rsb.xhrList = [];rsb.components = {};rsb.sessionTimeout = false;rsb.externalCheckUnsaveFunc = {};rsb.resourceLastModifiedCache = {};rsb.ajaxError = function(jqXHR, errorStatus, thrownError) {rsb.ajaxErrorMessage = "";var error = "Save failed: " + (typeof(thrownError) === "string" ? thrownError : thrownError.message);if (jqXHR && jqXHR.readyState > 0 && errorStatus && thrownError) {var isUpdateConflict = jqXHR.status === 412 && !!jqXHR.getResponseHeader("Last-Modified");thrownError = (typeof(thrownError) === "string" ? thrownError : thrownError.stack || "");!isUpdateConflict && console.log("AJAX " + errorStatus + ": (" + jqXHR.readyState + ", " + jqXHR.status + " - " + jqXHR.statusText + ") " + thrownError + " URL:" + this.url);if (this.url === "src/setAppLogs.rsb") {return false}
rsb.ajaxErrorMessage = (jqXHR.status || errorStatus) + " - " + this.url + " " + (thrownError || jqXHR.statusText);var conflictError = isUpdateConflict ? rsb.getResultErrorMessage(jqXHR.responseJSON?.items) : "";conflictError && console.warn(conflictError);error = conflictError || error;var resultContainer = $(this);if (resultContainer && resultContainer.length > 0) {resultContainer = resultContainer[0].resultContainer;if (resultContainer) {rsb.showResult(resultContainer, conflictError || ("AJAX " + errorStatus + ": " + rsb.ajaxErrorMessage), false)}}
!isUpdateConflict && $.ajax({dataType: "json",url: "src/setAppLogs.rsb",type: "POST",data: { "@json": true, type: "Error", script: "AJAX " + errorStatus, message: rsb.ajaxErrorMessage, timestamp: new Date().toUTCString() },error: function() {}})}
return error};rsb.abortAllAjax = function() {rsb.xhrList.forEach(function($xhr) {$xhr.abort()})}
$.ajaxSetup({error: rsb.ajaxError,beforeSend: function(xhr) {rsb.xhrList.push(xhr)},complete: function(xhr, status) {var index = rsb.xhrList.indexOf(xhr);if (index> -1) {rsb.xhrList.splice(index)}}});rsb.valiadInteger = function (value, element, param) {if (/^-?\d+$/.test(value)) {if (param == null || param.length <= 0) return true;value = parseInt(value);if (/^-?\d+$/.test(param)) {return value >= parseInt(param)} else {var params = $.parseJSON(param);if ($.isArray(params)) {var args = params;params = {};if (args.length > 0) params.min = args[0];if (args.length > 1) params.max = args[1];if (args.length > 2) params.setp = args[2]}
if (params.hasOwnProperty("min") && value < parseInt(params.min)) return false;if (params.hasOwnProperty("max") && value > parseInt(params.max)) return false;if (params.hasOwnProperty("step") && !!params.step && params.hasOwnProperty("min")) return Number.isInteger((value - parseInt(params.min)) / parseInt(params.step))}} else {var errors = {};errors[$(element).attr("name")] = 'Please enter only integer.';$(element).parents("form.form-settings").validate().showErrors(errors)}
return true}
$(document).ready(function() {$(document).ajaxComplete(function(e, jqXHR, ajaxOptions) {if (!rsb.sessionTimeout && jqXHR.getResponseHeader && (jqXHR.getResponseHeader("x-cdata-login") == "true" || jqXHR.getResponseHeader("x-cdata-unauth") == "true")) {rsb.sessionTimeout = true;if (!rsb.login && !rsb.unauth) {window.top.location.reload()}}});$.validator.addMethod("rsb-integer", rsb.valiadInteger, $.validator.format('The integer is out of range.'))});rsb.getValidationScope = function(element) {var group = $(element).closest("div.form-group-span");if (group.length <= 0) {group = $(element).closest("div.form-validate-error-container");if (group.length <= 0 ) {group = $(element).closest("div.form-group")}}
return group}
rsb.switchTab = function(e) {if (!$(e.target).attr("data-bs-target")) return;var lastTab = $("ul.nav-tabs li a.active").attr("data-bs-target");var form = $(lastTab).find("form");var unsavedText = rsb.checkUnsave(form, rsb.externalCheckUnsaveFunc[form.attr("id")]);var switchTab = true;var hasUnsavedText = unsavedText && unsavedText.length > 0;if (hasUnsavedText) {var target = $(e.target);rsb.confirmModal({title: 'Unsaved Changes',body: 'If you leave the page, any unsaved changes will be lost.  Are you sure you want to leave?',okStyle: "btn-outline-secondary",okText: 'Cancel',okIcon: false,cancelStyle: "btn-danger",cancelText: 'Leave Page',cancelIcon: false,cancel: function(){if (target.hasClass("tab-nohash-update")) {rsb._showTab(target.attr("data-bs-target") + "Tab")} else {window.location.hash = target.attr("data-bs-target") + "Tab"}
if(hasUnsavedText){rsb.revertUnsave(form)}}});e.preventDefault();rsb.stopPropagation(e)} else {if (switchTab == true) {var target = $(e.target);if (target.hasClass("tab-nohash-update")) {rsb._showTab($(e.target).attr("data-bs-target") + "Tab")} else {window.location.hash = $(e.target).attr("data-bs-target") + "Tab"}
if(hasUnsavedText){rsb.revertUnsave(form)}} else {e.preventDefault();rsb.stopPropagation(e)}}}
rsb.showTab = function() {rsb._showTab()}
rsb._showTab = function(hash) {var tab;hash = hash || window.location.hash;if (hash != undefined && hash.length > 0) {tab = $("ul.nav-tabs li:not(.disabled) a[data-bs-target='" + hash.replace(/Tab/g, "") + "']")}
if (!$("body").hasClass("flow") && (tab == undefined || tab.length <= 0)) {tab = $("ul.nav-tabs li:not(.disabled) a").first()}
if (tab && !tab.closest("ul").hasClass("self-handle")) {$(tab).tab("show");if ($($(tab).attr("data-bs-target")).find(".react-switch-tab")[0]) {var reactEvent = new Event("show.bs.tab");$($(tab).attr("data-bs-target")).find(".react-switch-tab")[0].dispatchEvent(reactEvent)}}}
rsb.beforeUnload = function(e) {var lastTab = $("ul.nav-tabs li a.active").attr("data-bs-target");var form = $(lastTab).children("form");return rsb.checkUnsave(form, rsb.externalCheckUnsaveFunc[form.attr("id")])}
rsb.revertUnsave = function(form) {$(form).each(function() {var effectedInputs = $();$(this).find("input,select").not(".rsb-form-nosubmit").each(function() {var isChanged = false;if ($(this).is("input")) {isChanged = this.value != this.defaultValue} else {$(this).find("option").each(function () {isChanged = this.defaultSelected != this.selected;return !isChanged})}
if (isChanged) {effectedInputs = effectedInputs.add(this)}});$(this).validate().resetForm();this.reset();$(this).trigger("reset");effectedInputs.trigger("change")});$(form).find("div.form-group").removeClass("has-warning").removeClass("has-error");for (var i = 0; i < rsb.editors.length; i++) {while (rsb.editors[i].historySize().undo > 0) {rsb.editors[i].undo()}}
rsb.initSubSettingsSwitcher()}
rsb.saveChanges = function(form) {$(form).find("div.form-group").removeClass("has-warning");var saveBtn = $(form).prop("saveButton");if (!saveBtn) {saveBtn = $(form).find("div.save-btn button[type=submit]")}
$.merge(saveBtn, $(form).parents("div.modal").find("div.modal-footer button[data-loading-text]"));var doSubmit = function() {saveBtn.button("loading");if ($(form).prop("data-validation") == "validating") {var waitTime = 0;var intervalId = window.setInterval(function() {waitTime += 100;var status = $(form).prop("data-validation");if (status == "success") {window.clearInterval(intervalId);rsb.submitForm(form, saveBtn)} else if (status != "validating") {window.clearInterval(intervalId);saveBtn.button("reset")} else if (waitTime > 60000) {window.clearInterval(intervalId);saveBtn.button("reset");rsb.showResult(rsb.getFormResultContainer(form), "Unable to validate form.", false);$(form).prop("data-validation", "failure")}}, 100)} else {rsb.submitForm(form, saveBtn)}};var beforeSubmitRlt = $(form).triggerHandler("beforeSubmit", form);if (typeof(beforeSubmitRlt) == 'function') {beforeSubmitRlt(doSubmit)} else if (beforeSubmitRlt != false) {doSubmit()}}
rsb._getLatestLastModified = function (lastModified, defaultLastModified) {if (!defaultLastModified || defaultLastModified === lastModified) return lastModified;else if (!lastModified) return defaultLastModified;else return new Date(lastModified).getTime() >= new Date(defaultLastModified).getTime() ? lastModified : defaultLastModified};rsb.setResourceLastModified = function (resId, lastModified) {if (!lastModified) return;rsb.resourceLastModifiedCache[resId] = lastModified;rsb.defaultLastModified = rsb._getLatestLastModified(lastModified, rsb.defaultLastModified)};rsb.getResourceLastModified = function (resId, defaultLastModified) {defaultLastModified = defaultLastModified || rsb.defaultLastModified;return rsb._getLatestLastModified(rsb.resourceLastModifiedCache[resId], defaultLastModified)};rsb.submitForm = function(form, saveBtn) {$.ajax({dataType: "json",type: $(form).attr("method"),url: $(form).attr("action"),data: rsb.getFormData(form, true),headers: {"If-Unmodified-Since": rsb.getResourceLastModified($(form).attr("id"))},traditional: true,success: function (data, textStatus, jqXHR) {var resultContainer = rsb.getFormResultContainer(form);var result = data["items"];var errorMsg = rsb.getResultErrorMessage(result);if (errorMsg) {rsb.showResult(resultContainer, errorMsg, false, false, true, true, 400);$(form).trigger("error", result)} else {result = result[0];var reload = rsb.checkReloadPage(form);if ($(form).hasClass("sync-changes")) {rsb.syncChanges($(form))}
if (reload) {window.location.reload()}
if (result && result["other:error"]) {rsb.showResult(resultContainer, result["other:error"], false, false, true, true, 400)} else if (result && result["other:warning"]) {rsb.showResult(resultContainer, result["other:warning"], "warning")} else {var successMsg = $(form).attr("data-success-message");if(successMsg) rsb.showResult(resultContainer, successMsg, true, true)}
rsb.setResourceLastModified($(form).attr("id"), jqXHR.getResponseHeader("Last-Modified"));$(form).trigger("success", result)}},error: function(jqXHR, errorStatus, thrownError) {var error = rsb.ajaxError(jqXHR, errorStatus, thrownError);if (error) {var resultContainer = rsb.getFormResultContainer(form);rsb.showResult(resultContainer, error, false);$(form).trigger("error", false)}}}).always(function() {saveBtn.button("reset")})}
rsb.checkReloadPage = function(form) {var reload = false;$(form).find("input[reload='true']").each(function () {if (this.type === "checkbox" || this.type === "radio") {if (this.checked !== this.defaultChecked) {reload = true}} else if (this.defaultValue != this.value) {reload = true}});return reload}
rsb.syncChanges = function(form) {var inputs = form.find("input[type=text], input[type=password], input[type=number], textarea");for (var i = 0; i < inputs.length; i++) {inputs[i].defaultValue = inputs[i].value}
var inputs = form.find("input[type=radio], input[type=checkbox]");for (var i = 0; i < inputs.length; i++) {inputs[i].defaultChecked = inputs[i].checked}
var options = form.find("option");for (var i = 0; i < options.length; i++) {options[i].defaultSelected = options[i].selected}
form.find("input, textarea, select").each(function () {$(this).data("rsb.syncChange")?.call(null)})}
rsb.expandCell = function(cell) {if (!rsb.hasSelection()) {var wrapped = cell.css("white-space") != "nowrap";if (wrapped == true) {cell.css("white-space", "nowrap")} else {cell.css("white-space", "normal")}}}
rsb.hasSelection = function() {if (window.getSelection && window.getSelection().rangeCount > 0 && window.getSelection().getRangeAt(0).toString().length > 0) {return true} else if (document.selection && ((document.selection.createRange().text && document.selection.createRange().text.length > 0)
|| (document.selection.createRange().endOffset > document.selection.createRange().startOffset))) {return true}
return false}
rsb.initTable = function(table, resource, errorContainer, initOptions) {$.extend(initOptions, {processing: true,serverSide: true,ajax: function(request, callback, settings) {var options = $.extend({}, initOptions);if (typeof(options.preAjax) == 'function') {options.preAjax(options, request)}
if (request.length > 0 && rsb.pageRecordsCount.get() != request.length && !options.onlyPublicResource) {rsb.pageRecordsCount.set(request.length)
$(".table-length").find("select").val(request.length).change()}
var ajaxWorker = function() {var requestData = { "@json": true, "$count": -1 };if (options["requestData"] != null) {$.extend(requestData, options["requestData"])}
requestData["$select"] = "*";if (request.columns) {requestData["$select"] = "";for (var i = 0; i < request.columns.length; i++) {if (request.columns[i].data != null && request.columns[i].data.length > 0) {if (requestData["$select"].length > 0) {requestData["$select"] += ","}
requestData["$select"] += request.columns[i].data}}
if (request.order && request.order.length > 0) {requestData["$orderby"] = request.columns[request.order[0].column].data + " " + request.order[0].dir}}
if (typeof(request.length) != 'undefined') {requestData["$top"] = request.length}
if (typeof(request.start) != 'undefined') {requestData["$skip"] = request.start}
var additionDataCount = 0;if (options["additionData"] && options["additionData"].length > 0) {if (typeof(options["additionData"][0]["count"]) != 'undefined') {additionDataCount = parseInt(options["additionData"][0]["count"])} else {additionDataCount = options["additionData"].length}
var columnCount = 0;for (var tmp in options["additionData"][0]) {columnCount ++}
if (columnCount == 1) {delete options["additionData"][0];options["additionData"].length--}
if (typeof(requestData["$skip"]) != 'undefined') {requestData["$skip"] = requestData["$skip"] - additionDataCount;if (requestData["$skip"] < 0) {requestData["$skip"] = 0}}
if (typeof(requestData["$top"]) != 'undefined') {if (options["additionData"].length < requestData["$top"]) {requestData["$top"] = request.length - (options["additionData"].length % request.length)} else {while (options["additionData"].length > requestData["$top"]) delete options["additionData"][options["additionData"].length - 1];requestData["$top"] = 0}}}
if (requestData["$top"] < 0) {requestData["$skip"] = -1}
var url = resource + "?" + rsb.securityRand();$.ajax({dataType: "json",url: url,type: "GET",data: requestData,success: function (data, textStatus, jqXHR) {if (jqXHR.getResponseHeader("LoginPage") && jqXHR.getResponseHeader("LoginPage").toLowerCase() == "true") {window.location.reload()}
var result = data["items"];var errorMsg = rsb.getResultErrorMessage(result);if (errorMsg) {rsb.showResult(errorContainer, errorMsg, false)} else {var count = 0;var columnCount = 0;if (result && result.length > 0) {count = parseInt(result[0]["count"]);for (var tmp in result[0]) {columnCount ++}
if (columnCount == 1) {delete result[0];result.length--}}
var tableData = { "draw": parseInt(request["draw"]) };if (options["additionData"]) {result = options["additionData"].concat(result);count += additionDataCount}
tableData["data"] = rsb.encodeTableData(result);tableData["recordsTotal"] = count;tableData["recordsFiltered"] = count;callback(tableData);table.find("td").click(function() {rsb.expandCell($(this))})}
if (typeof(options.afterAjax) == 'function') {options.afterAjax(options)}}})}
if (options.suspending) {var waitTime = 0;var intervalId = setInterval(function() {waitTime += 100;if (!options.suspending || waitTime >= 60000) {clearInterval(intervalId);ajaxWorker()}}, 100)} else {ajaxWorker()}}});$(table).DataTable(initOptions)}
rsb.xml_special_to_escaped_one_map = {'&': '&amp;','"': '&quot;','<': '&lt;','>': '&gt;'};rsb.escaped_one_to_xml_special_map = {'&amp;': '&','&quot;': '"','&lt;': '<','&gt;': '>'};rsb.encodeXml = function(string) {return string.replace(/([\&"<>])/g, function(str, item) {return rsb.xml_special_to_escaped_one_map[item]})};rsb.decodeXml = function(string) {return string.replace(/(&quot;|&lt;|&gt;|&amp;)/g, function(str, item) {return rsb.escaped_one_to_xml_special_map[item]})}
rsb.htmlDecode = function(value){return $('<div></div>').html(value).text()}
rsb.encodeTableData = function(data) {var result = [];for (var i in data) {var row = {};for (var j in data[i]) {row[j] = data[i][j] != null ? rsb.htmlEncode(data[i][j]) : null}
result.push(row)}
return result}
rsb.decodeRowData = function(data) {var result = {};for (var i in data) {result[i] = data[i] != null ? rsb.htmlDecode(data[i]) : null}
return result}
rsb.toggleSelected = function(e, table) {var target = $(e.target);table = table || target.parents("table:eq(0)");var inputList = table.find("input[type='checkbox']:gt(0)");if (e.target.parentElement.tagName.toLowerCase() == "th") {if (target.prop("checked")) {inputList.prop("checked", true)} else {inputList.prop("checked", false)}} else {if (inputList.length == inputList.filter(":checked").length) {table.find("input[type='checkbox']:eq(0)").prop("checked", true)} else {table.find("input[type='checkbox']:eq(0)").prop("checked", false)}}}
rsb.InfoModal = rsb.InfoModal || {};rsb.InfoModal.state = 0;rsb.showInfoModal = function(title, message, allowClose, showProgress, maxValue, allowCancel, shownCallback) {$("#infoModalLabel").html(title);$("#infoModalBody").html(message);if (!allowClose) {$("#infoModal").modal({backdrop: "static"})}
rsb.InfoModal.state = 1;if (shownCallback) {rsb.InfoModal.state = 0;$("#infoModal").one("shown.bs.modal", shownCallback)} else {$("#infoModal").one("shown.bs.modal", function(){rsb.InfoModal.state = 2})}
if (showProgress) {$("#infoModalProgress").parent().removeClass("hide");$("#infoModalProgress").attr("aria-valuemax", maxValue || 100);$("#infoModalProgress").attr('aria-valuenow', 0).css('width', "0%")} else {$("#infoModalProgress").parent().addClass("hide")}
if (allowCancel) {$("#infoModalClose").addClass("hide");$("#infoModalProgress").attr("data-cancel", false);$("#infoModalProgress").attr("data-success", false);$("#infoModalCancel").parent().removeClass("hide")} else {$("#infoModalCancel").parent().addClass("hide");$("#infoModalClose").removeClass("hide")}
$("#infoModal").modal('show')}
rsb.closeInfoModal = function() {if (rsb.InfoModal.state == 1) {setTimeout(rsb.closeInfoModal, 100)} else {rsb.InfoModal.state = 0;$("#infoModal").modal('hide')}}
rsb.changeInfoModalMessage = function(message) {$("#infoModalBody").html(message)}
rsb.increaseInfoModalProgress = function() {var maxValue = parseInt($("#infoModalProgress").attr('aria-valuemax'));var value = parseInt($("#infoModalProgress").attr('aria-valuenow'));value++;$("#infoModalProgress").attr('aria-valuenow', value).css('width', value*100/maxValue+"%");$("#infoModalProgress").attr("data-success", true)}
rsb.checkInfoModalState = function(start, count) {var isContinue = false;if (start < count && $("#infoModalProgress").attr("data-cancel") == "false") {$("#infoModalProgress").attr("data-success", false);isContinue = true}
return isContinue}
rsb.showInfoModalResult = function(errorContainer, message, success, showErrorDetail, showErrorBtn) {if ($("#infoModalProgress").attr("data-cancel") == "true" &&
((typeof(success) == "string" && success.toLowerCase() == "success") ||
(typeof(success) == "boolean" && success))) {success = "warning";var affects = parseInt($("#infoModalProgress").attr("aria-valuenow"));var affectsMax = parseInt($("#infoModalProgress").attr("aria-valuemax"));message = $("#infoModalLabel").text() + ' was canceled. ' + affects + ' out of ' + affectsMax + ' files were processed. Result: ' + message}
rsb.showResult(errorContainer, message, success, showErrorDetail, showErrorBtn)}
rsb.loadEditIPModal = function(modal, targetList) {var selectedRow = targetList.find(".api-security-selected-row");if (!selectedRow[0]) {alert('You must select an IP address to edit.')} else {var ipaddress = selectedRow.find(".ips-address").text();var comment = selectedRow.find(".comment").text();modal.find("#RawIPAddress").val(ipaddress);modal.find("input[name='IPAddress']").val(ipaddress);modal.find("input[name='Comment']").val(comment);modal.modal('show')}}
rsb.onSecurityTableRowSelected = function(elem, btngroup) {if (elem.hasClass("api-security-selected-row")) {elem.removeClass("api-security-selected-row");btngroup.find(".edit-btn").addClass("disabled");btngroup.find(".del-btn").addClass("disabled")} else {elem.siblings().removeClass("api-security-selected-row");elem.addClass("api-security-selected-row");btngroup.find(".edit-btn").removeClass("disabled");btngroup.find(".del-btn").removeClass("disabled")}}
rsb.generateNewToken = function(elem, callback) {$.get("src/generateNewToken.rsb?@json&" + rsb.securityRand(), function(result) {var authtoken = result.items[0].authtoken;if (callback) {var name = callback($(elem).closest('form'));if (name && name.length > 0) {authtoken = name + ":" + authtoken}}
elem.val(authtoken)})}
rsb.sendTestEmail = function(sendBtn, formOrData) {formOrData = formOrData || $("#notificationForm");var isForm = formOrData instanceof jQuery;sendBtn.button("loading");var mailData = isForm ? rsb.getFormData(formOrData, true) : formOrData;var params = {};params["@json"] = true;params["to"] = mailData["NotifyEmailTo"];params["async"] = false;params["logfile"] = true;$.post('src/sendTestEmail.rsb', params, function(data) {var errorMsg = rsb.getResultErrorMessage(data.items);var logfile = data.items?.[0]?.logfile?.toLowerCase() == "true";var downloadLink = '<a class="btn btn-outline-secondary pull-right" style="margin-top: -5px;" href="src/downloadTestEmailLog.rst" download="testEmailLogs.log" role="button"><i class="fa fa-download"></i> ' + 'Download Logs'+ ' </a>';if (errorMsg) {rsb.showResult($("#sendEmailResult"), (logfile ? downloadLink : "") + 'Error sending email'+ ': ' + errorMsg, "error", true)} else {if (isForm) {var unsavedText = rsb.checkUnsave(formOrData);if (unsavedText && unsavedText.length > 0) {formOrData.children("div.form-group").removeClass("has-warning");formOrData.submit()}}
rsb.showResult($("#sendEmailResult"), (logfile ? downloadLink : "") + 'The test email was sent.', "success", true)}}).fail(function() {rsb.showResult($("#sendEmailResult"), 'An error occurred while sending the email:&nbsp;'+ rsb.ajaxErrorMessage, "error", false, true, false, 400)}).always(function() {sendBtn.button("reset")})}
rsb.clearForm = function(form) {form.validate().resetForm();form[0].reset();form.children("div.form-group").removeClass("has-error");form.find("div.alert").hide()}
rsb.getFirstFormElement = function(obj) {var textElements = $(obj).find("input:visible:enabled:not([readonly]), textarea:visible:enabled:not([readonly]), select:visible:enabled:not([readonly])");if (textElements.length > 0) {return textElements.first()} else {return $(obj)}}
$.fn.extend({modalFirstElementFocus: function() {console.warn("modalFirstElementFocus: this method is deprecated");$(this).on('shown.bs.modal', function () {rsb.getFirstFormElement(this).focus()})},navTabsFirstElementFocus: function () {$(this).find("li>a").on('shown.bs.tab', function(e) {var target = $(this).attr("data-bs-target");rsb.getFirstFormElement(target).focus()})},formFirstElementFocus: function() {rsb.getFirstFormElement(this).focus()}});rsb.getJavascript = function() {$('.ex-javascript').show();$('.ex-curl').hide();$('.format-btn').html('JavaScript')}
rsb.getCURL = function() {$('.ex-javascript').hide();$('.ex-curl').show();$('.format-btn').html('cURL')}
rsb.triggerClickBaseHash = function(filter) {var hash = window.location.hash;var containerFilter = filter || "";containerFilter = (containerFilter)?containerFilter+" ":containerFilter;if (hash != undefined && hash.length > 0) {var linkObj = $(containerFilter + "a[href='" + rsb.escapeSelector(hash) + "']");linkObj.click();if(containerFilter && linkObj.parent("li").length > 0){$(containerFilter + " li").removeClass("selected");linkObj.parent("li").addClass("selected")}}}
rsb.xmlUnescape = function (text) {return (text + '').replace("&amp;", '&').replace("&lt;", '<').replace("&gt;", '>').replace("&quot;", '"')}
rsb.formatTimestamp = function(dateTime) {if (dateTime != undefined && dateTime.length > 0) {var date = new Date(dateTime);var year = date.getFullYear();var month = date.getMonth()+1;var day = date.getDate();var hour = date.getHours();var minute = date.getMinutes();var second = date.getSeconds();if (month < 10) {month = '0' + month}
if (day < 10) {day = '0' + day}
if (hour < 10) {hour = '0' + hour}
if (minute < 10) {minute = '0' + minute}
if (second < 10) {second = '0' + second}
return year + "-" + month + "-" + day + "T" + hour + ":" + minute + ":" + second}
return dateTime}
rsb.parseDatetime = function(datetimeString) {return new Date(datetimeString)}
rsb.initSubSettingsSwitcher = function() {$(".subsettings-switcher").each(function() {var switcher = $(this).is("input") ? $(this) : $(this).find("input");if (switcher.length <= 0) {switcher = $(this).is("select") ? $(this) : $(this).find("select")}
if (switcher) {var action = $(this).attr("data-subsettings-action") || "enable";var expresion = $(this).attr("data-switch-expression");var subSelector = $(this).attr("data-subsettings-selector");var subsettings = $(subSelector).filter("input,select,button").add($(subSelector).find("input,select,button"));if (switcher.is("input")) {if (switcher.attr("type") == "checkbox" || switcher.attr("type") == "radio") {rsb.switchSubSettings(expresion ? eval(expresion) : switcher.prop("checked"), subSelector, action);switcher.change(function(){rsb.switchSubSettings(expresion ? eval(expresion) : $(this).prop("checked"), subSelector, action);$(this).trigger("subsettingsSwitch")});switcher.trigger("subsettingsSwitch")} else if (switcher.attr("type") == "text" || switcher.attr("type") == "password") {rsb.switchSubSettings(expresion ? eval(expresion) : switcher.val() != "", subSelector, action);switcher.on("keyup change", function(){rsb.switchSubSettings(expresion ? eval(expresion) : $(this).val() != "", subSelector, action);$(this).trigger("subsettingsSwitch")});switcher.trigger("subsettingsSwitch")}} else if (switcher.is("select")) {rsb.switchSubSettings(expresion ? eval(expresion) : switcher.val() != "", subSelector, action);switcher.change(function(){rsb.switchSubSettings(expresion ? eval(expresion) : $(this).val() != "", subSelector, action);$(this).trigger("subsettingsSwitch")});switcher.trigger("subsettingsSwitch")}}})}
rsb.switchSubSettings = function(on, subSelector, action) {if (action == "enable") {var subsettings = $(subSelector).filter("input,select,textarea,button").add($(subSelector).find("input,select,textarea,button"));subsettings.prop("disabled", !on)} else if (action == "disable") {var subsettings = $(subSelector).filter("input,select,textarea,button").add($(subSelector).find("input,select,textarea,button"));subsettings.prop("disabled", on)} else if (action == "show") {var subsettings = $(subSelector);if (on) {subsettings.removeClass("hidden")} else {subsettings.addClass("hidden")}} else if (action == "hide") {var subsettings = $(subSelector);if (on) {subsettings.addClass("hidden")} else {subsettings.removeClass("hidden")}}}
rsb.setDraftCssAttribute = function(elem, name, value) {var prefix = [ "", "-webkit-", "-moz-", "-ms-", "-o-" ];for (var i in prefix) {$(elem).css(prefix[i] + name, value)}}
rsb.getDraftCssAttribute = function(elem, name) {var prefix = [ "", "-webkit-", "-moz-", "-ms-", "-o-" ];for (var i in prefix) {var value = $(elem).css(prefix[i] + name);if (value) {return value}}}
rsb.isTruncated = function(obj) {return obj && $(obj)[0].offsetWidth < $(obj)[0].scrollWidth}
rsb.toArray = function(obj) {if (obj instanceof Array) {return obj} else {return [obj]}}
rsb.odataEscape = function(str) {return "'" + (str || "").replace(/'/g, "\\'") + "'"}
rsb.copyToClipboard = function(content, containerId, currentItem) {var succeed = false;try {navigator.clipboard.writeText(content);succeed = true} catch (e) {var targetId = "_hiddenCopyText_" + (containerId || "");target = document.getElementById(targetId);if (!target) {var target = document.createElement("textarea");target.style.position = "absolute";target.style.left = "-9999px";target.style.top = "0";target.id = targetId;if (containerId) {document.getElementById(containerId).appendChild(target)} else {document.body.appendChild(target)}}
target.textContent = content;var currentFocus = currentItem || document.activeElement;target.focus();target.setSelectionRange(0, target.value.length);try {succeed = document.execCommand("copy")} catch (e) {succeed = false}
if (currentFocus && typeof currentFocus.focus === "function") {currentFocus.focus()}
target.textContent = ""}
return succeed}
rsb.initCopyToClipboard = function ($copyElements, $modalId) {var copyElements = $copyElements || $(".copy-to-clipboard");var copyReminder = 'Copy to clipboard';var copiedReminder = 'Copied';var tooltipConfig = {};if ($(copyElements.get(0)).is("td")) {tooltipConfig["container"] = "body"}
copyElements.attr("title", copyReminder).tooltip(tooltipConfig);if ($modalId) {copyElements.attr("data-container-modal", $modalId)}
copyElements.on("click", function () {var content = $.trim($(this).is("input") ? $(this).val() : $(this).text());var modalId = $(this).attr("data-container-modal");$(this).tooltip('dispose');if (content && rsb.copyToClipboard(content, modalId, $(this))) {$(this).attr("title", copiedReminder);$(this).tooltip('show')}}).on("mouseout", function () {$(this).tooltip('dispose');$(this).attr("title", copyReminder);$(this).tooltip()})}
rsb.register = function(modal, btn, register) {var postData = {"register": register};var form = modal.find("form.form-settings");if (register) {if (form.valid()) {$.extend(postData, rsb.getFormData(form, false))} else {return}}
btn.button("loading");$.ajax({url: "src/register.rst",data: postData,method: "POST",success: function(data) {var errorMsg = rsb.getResultErrorMessage(data["items"]);if (errorMsg) {rsb.showResult(form.find("div.form-result-static"), errorMsg, false)} else {if (register) {rsb.showResult(form.find("div.form-result-static"), 'Thank You.', true)}
modal.modal("hide")}}}).always(function() {btn.button("reset")})}
if (!String.prototype.startsWith) {Object.defineProperty(String.prototype, 'startsWith', {value: function (searchString, position) {position = position || 0;return this.substr(position, searchString.length) === searchString}})}
if (!String.prototype.endsWith) {Object.defineProperty(String.prototype, 'endsWith', {value: function (pattern) {var d = this.length - pattern.length;return d >= 0 && this.lastIndexOf(pattern) === d}})}
if (!String.prototype.includes) {Object.defineProperty(String.prototype, 'includes', {value: function (search, start) {'use strict';if (typeof start !== 'number') {start = 0}
if (start + search.length > this.length) {return false} else {return this.indexOf(search, start) !== -1}}})}
if (!Array.prototype.includes) {Object.defineProperty(Array.prototype, 'includes', {value: function(valueToFind, fromIndex) {if (this == null) {throw new TypeError('"this" is null or not defined')}
var o = Object(this);var len = o.length >>> 0;if (len === 0) {return false}
var n = fromIndex | 0;var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);function sameValueZero(x, y) {return x === y || (typeof x === 'number' && typeof y === 'number' && isNaN(x) && isNaN(y))}
while (k < len) {if (sameValueZero(o[k], valueToFind)) {return true}
k++}
return false}})}
rsb.getMapFromString = function($str, $separator, $delimiter, $keyToLower) {var map = {};var buffer = "";var name = "";var value = "";var escape = false;var inValue = false;$separator = $separator || ';';$delimiter = $delimiter || '=';for (var i in $str) {var c = $str[i];if (escape) {buffer += c;escape = false} else if (c == '\\') {escape = true} else if (c == $delimiter && !inValue) {name = buffer.trim();buffer = "";inValue = true} else if (c == $separator) {value = buffer.trim();buffer = "";if (name.length > 0) {map[$keyToLower ? name.toLowerCase() : name] = value}
name = value = "";inValue = false} else {buffer += c}}
if (buffer.length > 0 || name.length > 0) {if (name.length <= 0) {name = buffer.trim();value = ""} else {value = buffer.trim()}
if (name.length > 0) {map[$keyToLower ? name.toLocaleLowerCase() : name] = value}}
return map}
rsb.getStringFromMap = function($map, $separator, $delimiter, $keyToLower) {var mapStr = "";$separator = $separator || ';';$delimiter = $delimiter || '=';for (var key in $map) {var keyStr = key.replace(new RegExp("\\\\", "g"), "\\\\").replace(new RegExp($separator, "g"), "\\" + $separator).replace(new RegExp($delimiter, "g"), "\\" + $delimiter);if ($keyToLower) {keyStr = keyStr.toLowerCase()}
var valueStr = $map[key].replace(new RegExp("\\\\", "g"), "\\\\").replace(new RegExp($separator, "g"), "\\" + $separator);if (keyStr) {mapStr += keyStr + $delimiter + valueStr + $separator + " "}}
return mapStr}
rsb.uploadFile = function($url, $inputName, $files, $resultContainer, $callback, $always, $additionData, $headers) {var $hasFile = false;var $formData = new FormData();if ($files && !$.isArray($files)) {$files.each(function() {var $file = $(this);var $name = $file.attr("name") || $inputName;Array.prototype.forEach.call($file[0].files, function($fileItem) {$formData.append($name, $fileItem);$hasFile = true})})} else if ($files && $inputName && $.isArray($files)) {Array.prototype.forEach.call($files, function($fileItem) {$formData.append($inputName, $fileItem);$hasFile = true})}
if (!$hasFile) {$resultContainer && rsb.showResult($resultContainer, 'Please select at least one file to upload.', "info");if ($always) {$always()}
return false}
var $request = new XMLHttpRequest();if ($callback) {$request.onload = function() {$callback(!!$request.responseText ? JSON.parse($request.responseText) : { "items": [{ "errormessage": $request.statusText }]}, $request)};$url += ($url && $url.indexOf('?') > 0 ? "&@json" : "?@json");$formData.append("@json", "true")}
if ($always) {$request.onloadend = function() {$always()}}
if (typeof ($additionData) != 'undefined') {for (var key in $additionData) {$formData.append(key, $additionData[key])}}
$request.open("POST", $url);if ($headers) {for (var header in $headers) {$request.setRequestHeader(header, $headers[header])}}
$request.send($formData);return true}
rsb.initRestrictionFeatures = function($role, $container) {$role = ($role || "").toLowerCase();$container = ($container || $(document));var $roles = ["disabled", "admin", "standard", "support", "true"];for (var $index = 0; $index < $roles.length; $index++) {if ($roles[$index] == $role) break;var attr = "[restrict='" + $roles[$index] + "']";var $restrictGroups = $container.find("div" + attr + ", form" + attr);$restrictGroups.find("button:not(.no-restrict)").prop("disabled", true).hide();$restrictGroups.find("input:not(.no-restrict), select:not(.no-restrict), textarea:not(.no-restrict)").prop("readonly", true).prop("disabled", true).off("mousedown").on("mousedown", function() { return false; });$container.find("input" + attr + ":not(.no-restrict), select" + attr + ":not(.no-restrict), textarea" + attr + ":not(.no-restrict)").prop("readonly", true).prop("disabled", true).off("mousedown").on("mousedown", function() { return false; });$container.find("input" + attr + "[type='checkbox']:not(.no-restrict), input" + attr + "[type='radio']:not(.no-restrict)").parent("label").off("mousedown").on("mousedown", function() { return false; });$container.find("option" + attr + ":not(.no-restrict)").prop("disabled", true)}}
rsb.hasRestriction = function($requiredRole) {var currentUserRole = $("body").attr("data-role");if (!$requiredRole || !currentUserRole) return false;var $roles = {"disabled": 0, "admin": 1, "standard": 2, "support": 3, "true": 4};var requiredRoleIndex = $roles[$requiredRole];var currentUserRoleIndex = $roles[currentUserRole];if (requiredRoleIndex && currentUserRoleIndex && currentUserRoleIndex <= requiredRoleIndex && requiredRoleIndex != 4) {return false}
return true}
rsb.registerComponent = function ($name, $component) {$name = $name || "";rsb.components[$name] = $component;$(document).trigger("registerComponent." + $name)}
rsb.renderComponent = function ($name, $ele, $props) {if (!$ele) return false;$name = $name || "";if (!rsb.components[$name]) return false;!!$ele.__unmount__ && ($ele.__unmount__(), $ele.__unmount__ = null);$ele.__unmount__ = !!rsb.components[$name] && rsb.components[$name]($ele, $props);$($ele).addClass("rsb-root-component").off("unmountComponent").one("unmountComponent", rsb.unmountComponent.bind(null, $ele));return $ele.__unmount__}
rsb.unmountComponent = function ($ele) {if (!$ele) return false;$($ele).remove("rsb-root-component").off("unmountComponent");!!$ele.__unmount__ && ($ele.__unmount__(), $ele.__unmount__ = null)}
rsb.bindData = function ($ele, $key, $value) {return $($ele).data($key, $value)}
rsb.pageRecordsCount = {"key": null,"getkey": function() {if (!this.key) {this.key = ($("body").attr("data-prod") || "cdataapp") + "_pageRecordsCount"}
return this.key},"get": function() {return window.localStorage ? parseInt(window.localStorage.getItem(this.getkey()) || "10") : 10},"set": function($count) {if (window.localStorage) {window.localStorage.setItem(this.getkey(), $count)}}};$(document).ready(function() {$("[data-bs-toggle='popover']").popover({container: 'body',placement: 'top'});$("[data-bs-toggle='tooltip']").tooltip();rsb.initSettingsForms();rsb.initSubSettingsSwitcher();rsb.initCopyToClipboard();$("ul.nav-tabs:not(.self-handle) li:not(.disabled) a").click(rsb.switchTab);rsb.showTab();window.onbeforeunload = rsb.beforeUnload;window.onhashchange = rsb.showTab;(function() {var _getStateParentGroup = function(input) {var group = input.parents("div.form-group");if (!group.length) {group = input.parent()} else if (group.length > 1) {group = $(group.get(0))}
return group}
$(document).on("keydown", "input", function(event) {event = event || window.event;if (!event || !event.target) return true;var input = $(event.target);if (!input.attr("type") || input.attr("type").toLowerCase() != "password" || $(input).parents("#connectorSettingsModalContainer").length > 0) return true;var group = _getStateParentGroup(input);var lockState = group.children('div.app-caps-lock-state');if (window.event && window.event.getModifierState && window.event.getModifierState("CapsLock")) {if (!lockState.length) {group.append('<div class="app-caps-lock-state"> ' + 'Caps lock is ON.'+ '</div>')}} else {lockState.remove()}
return true}).on("focusout", "input", function(event) {event = event || window.event;event && event.target && _getStateParentGroup($(event.target)).children('div.app-caps-lock-state').remove();return true})})();(function($) {$.fn.button = function(action) {this.each(function(index){if (action === 'loading' && $(this).data('loading-text')) {if (!$(this).data('original-text')) $(this).data('original-text', $(this).html());$(this).html($(this).data('loading-text')).prop('disabled', true)} else if ($(this).data(action + '-text')) {if (!$(this).data('original-text')) $(this).data('original-text', $(this).html());$(this).html($(this).data(action + '-text')).prop('disabled', true)} else if (action === 'reset' && $(this).data('original-text')) {$(this).html($(this).data('original-text')).prop('disabled', false)}});return this}}(jQuery))});