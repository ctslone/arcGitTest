rsb.as2Profile = rsb.as2Profile || {};rsb.as2Profile.options = {};$(document).ready(function() {var form = $("#as2profilesettings_form");form.on("beforeSubmit", function() {var newName = form.find("#as2profilesettings_as2_identifier").val();var oldName = form.find("#as2profilesettings_as2_identifier")[0].defaultValue;if (oldName != null && oldName.length > 0 && newName != oldName) {return confirm(rsb.evalTemplate('Do you want to change the identifier from "$oldName$" to "$newName$"?', {"oldName" : oldName, "newName" : newName}))}}).on("success", function() {rsb.as2Profile.oldPrivateCert = form.find("#as2profilesettings_private_key_path").val();rsb.as2Profile.oldPublicCert = form.find("#as2profilesettings_public_key_path").val()});$("#as2profilesettings_enable_public_profile").change(function() {if ($(this).prop("checked")) {$("#as2profilesettings_public_settings").removeClass("hidden")} else {$("#as2profilesettings_public_settings").addClass("hidden")}});$("#as2profilesettings_asynchronous_mdn_url").change(function() {asynchronousmdnurl = $(this).val();asyncdomain = rsb.as2Profile.getUrlDomain(asynchronousmdnurl)})});rsb.as2Profile.init = function($options) {rsb.as2Profile.options = $options || {};rsb.as2Profile.oldPrivateCert = rsb.as2Profile.options.privatekeypath || "";rsb.as2Profile.oldPublicCert = rsb.as2Profile.options.publickeypath || ""}
rsb.as2Profile.getUrlDomain = function(url) {var data = url.split('/');if (data.length > 1) {return data[2].split(':')[0]} else {return ""}}
rsb.as2Profile.onChangePersonalCert = function() {if (rsb.as2Profile.oldPrivateCert != null && rsb.as2Profile.oldPrivateCert.length > 0) {var form = $("#as2profilesettings_form");var newPrivateCert = form.find("#as2profilesettings_private_key_path").val();if (newPrivateCert != rsb.as2Profile.oldPrivateCert) {$("#as2profilesettings_change_private_cert_modal").modal("show")} else {form.find("#as2profilesettings_private_key_password").val(rsb.connect.pswdmask)}}};rsb.as2Profile.RetainPersonalCert = function(opt) {var form = $("#as2profilesettings_form");if (opt == 1) {form.find("#as2profilesettings_private_key_password").val("");return}
var oldPrivateCert = null;form.find("#as2profilesettings_private_key_path option").each(function (){if (this.defaultSelected == true) {oldPrivateCert = this.value}});if (oldPrivateCert != null) {if (opt == 0) {form.find("#as2profilesettings_rollover_private_key_path").val(oldPrivateCert);form.find("#as2profilesettings_rollover_private_key_password").val("");form.find("#as2profilesettings_private_key_password").val("")} else if (opt == 2) {form.find("#as2profilesettings_private_key_path").val(oldPrivateCert)}}};